# 多进程的浏览器
一个浏览器是多进程，包含：
1. 浏览器（Brower）进程：浏览器的主进程，负责浏览器的协调、主控。如
    1. 负责浏览器界面显示，与用户交互。如前进、后退等。
    2. 负责个页面的进程管理。
    3. 网络资源的管理、下载
2. 第三方插件进程：每个插件对应一个进程。
3. GPU进程：最多一个，用于3D绘制。
4. 页面进程：每个页面一个进程，互不影响。

## 多进程优势
1. 避免单个页面或插件影响到整个浏览器。
2. 多进程充分利用多核优势。
坏处就是内存消耗大。

## 浏览器内核（渲染进程）
1. GUI渲染线程
    - 主要负责页面的渲染，解析HTML、CSS，构建DOM树，布局和绘制等。
    - 当界面需要重绘或者由于某种操作引发回流时，将执行该线程。
    - 该线程与JS引擎线程互斥，当执行JS引擎线程时，GUI渲染会被挂起，当任务队列空闲时，主线程才会去执行GUI渲染。
2. JS引擎线程
    - 该线程负责处理 JavaScript脚本，执行代码。
    - 也是主要负责执行准备好待执行的事件，即定时器计数结束，或者异步请求成功并正确返回时，将依次进入任务队列，等待 JS引擎线程的执行。
    - 当然，该线程与 GUI渲染线程互斥，当 JS引擎线程执行 JavaScript脚本时间过长，将导致页面渲染的阻塞。
3. 事件触发线程
    - 主要负责维护任务队列，将准备好的事件交给 JS引擎线程执行。
    - 比如 setTimeout定时器计数结束， ajax等异步请求成功并触发回调函数，或者用户触发点击事件时，该线程会将整装待发的事件依次加入到任务队列的队尾，等待 JS引擎线程的执行。
4. 定时触发器线程
    - 负责执行异步定时器一类的函数的线程，如： setTimeout，setInterval。
    - 主线程依次执行代码时，遇到定时器，会将定时器交给该线程处理，当计数完毕后，事件触发线程会将计数完毕后的事件加入到任务队列的尾部，等待JS引擎线程执行。
5. 异步http请求线程
    - 每个http请求都会新开一个线程请求。
    - 负责执行异步请求一类的函数的线程，如： Promise，axios，ajax等。

> GUI渲染线程与JS引擎线程是互斥的，当JS引擎执行时GUI线程会被挂起（相当于被冻结了），GUI更新会被保存在一个队列中等到JS引擎空闲时立即被执行。

![image](https://segmentfault.com/img/remote/1460000012925880) 