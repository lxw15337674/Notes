# Map，Set，WeakMap与WeakSet

数组在 JS 中的使用正如其他语言的数组一样，但缺少更多类型的集合导致数组也经常被当作队列与栈来使用。 数组只使用了数值型的索引，而如果非数值型的索引是必要的，开发者便会使用非数组的对 象。

**Map** 

Map与Object，其最本质的区别，键值对的集合（Hash 结构），但是传统上只能用字符串当作键。

对于Map来说，undefined和null是两个不同的键，布尔值true和字符串true是两个不同的键，而NaN之间视为同一个键 ，0和-0也是一个键，

```
const map = new Map();
map.set(['a'], 1);
map.get(['a']) 
```

会输出underfined。

**WeakMap**

WeakMap跟Map结构类似，也是用于生成键值对的集合,但是他只能用对象，来作为键值。其次，WeakMap的键名所指向的对象，不计入垃圾回收机制。

WeakMap 与 Map 在 API 上的区别主要是两个，一是没有遍历操作（即没有keys()、values()和entries()方法），也没有size属性。因为没有办法列出所有键名，某个键名是否存在完全不可预测，跟垃圾回收机制是否运行相关。这一刻可以取到键名，下一刻垃圾回收机制突然运行了，这个键名就没了，为了防止出现不确定性，就统一规定不能取到键名。二是无法清空，即不支持clear方法。因此，WeakMap只有四个方法可用：get()、set()、has()、delete()。

WeakMap的实例比较少，个人从来没有在实践中使用。但有这么一个实例相对适合：**比如我们要统计一个页面统计该页面所有节点的点击次数**。

- 其一，首先我们获取到的dom是一个对象，符合作为键值。
- 其二，当对应的节点消失的时候，垃圾回收机制，回自动回收对应的在WeakMap节点，同时达到释放内存的目的

**Set** 

Set可能相对更好理解，他可以简单理解为是一个“无重复值”的“有序”列表，且运行值方便快速访问以及判断。

我们可以利用他去重。包括数组，字符串等。

也可以利用他去接受一些具有 iterable 接口的其他数据结构，例如我们统计页面有几个div? new Set(document.querySelectorAll('div'));

